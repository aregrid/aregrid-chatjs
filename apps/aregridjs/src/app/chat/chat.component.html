<aregrid-header />

<div class="flex h-screen">
  <!-- Workspace Sidebar -->
  <div class="flex shadow">
    <aregrid-sidebar />
  </div>

  <!-- Main content (chat area and input field) -->
  <div class="flex flex-grow flex-col lg:flex-row overflow-hidden">
    <!-- Chat Area -->
    <main class="flex-grow p-6 overflow-y-scroll border-r">
      <div
        class="flex flex-col relative"
        [ngStyle]="{ height: 'calc(100% - 4rem)' }"
      >
        <div class="flex flex-col flex-grow overflow-y-scroll mt-4">
          <div class="flex-shrink-0"></div>
          <div class="flex flex-col space-y-4 mt-4">
            <ng-container *ngFor="let message of chatMessages">
              <aregrid-chat-message
                *ngIf="message.type === 'affine'"
                [avatar]="message.userAvatar"
                [userName]="message.userName"
                [content]="message.content"
              >
                <aregrid-affine templateId="chat"></aregrid-affine>
              </aregrid-chat-message>

              <aregrid-chat-message
                *ngIf="message.type === 'text'"
                [avatar]="message.userAvatar"
                [userName]="message.userName"
                [content]="message.content"
              >
              </aregrid-chat-message>
            </ng-container>
            <div #chatBottom class="pb-16"></div>
          </div>
        </div>
        <div class="absolute bottom-0 left-0 right-0 h-16">
          <!-- Slack-style chat input -->
          <div class="flex bg-white rounded-lg shadow p-4">
            <input
              type="text"
              [(ngModel)]="newMessage"
              (keyup.enter)="sendMessage()"
              placeholder="Type a message..."
              class="flex-grow outline-none px-2 py-1 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-blue-500"
            />
            <button
              type="button"
              class="ml-2 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600"
              (click)="sendMessage()"
            >
              Send
            </button>
            <button
              type="button"
              class="ml-2 px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600"
              (click)="sendMessage('affine')"
            >
              Send affine
            </button>
            <div class="flex items-center ml-2">
              <button
                type="button"
                class="px-2 py-1 bg-gray-200 rounded-full hover:bg-gray-300"
                title="Add Emoji"
              >
                ðŸ˜„
              </button>
              <input
                type="file"
                accept="image/*"
                class="hidden"
                (change)="handleImageUpload($event)"
              />
              <button
                type="button"
                class="px-2 py-1 bg-gray-200 rounded-full hover:bg-gray-300"
                title="Upload Image"
                (click)="openImageUploader()"
              >
                ðŸ“·
              </button>
              <input
                type="file"
                accept=".pdf,.docx,.xlsx"
                class="hidden"
                (change)="handleDocumentUpload($event)"
              />
              <button
                type="button"
                class="px-2 py-1 bg-gray-200 rounded-full hover:bg-gray-300"
                title="Attach Document"
                (click)="openDocumentUploader()"
              >
                ðŸ“Ž
              </button>
              <button
                type="button"
                class="px-2 py-1 bg-gray-200 rounded-full hover:bg-gray-300"
                title="Schedule Meeting"
                (click)="openMeetingScheduler()"
              >
                ðŸ“…
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <aregrid-footer />
  </div>
</div>
